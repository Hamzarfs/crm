import{_ as te}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-BH4UBKf3.js";import{r as B}from"./validators-Z6BjoYpS.js";import{d as A,r as i,o as F,g as P,f as t,b as e,n as s,aG as w,aL as j,ai as k,p as v,aK as L,w as re,aM as M,c as le,a0 as z,v as oe,e as se,a as ne}from"./main-DoQFmMsa.js";import{_ as G}from"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-BjbO3N_D.js";import{V as I}from"./VDivider-CiGpRMeQ.js";import{b as E,V as R,c as ie}from"./VCard-CvMXks-w.js";import{V as K}from"./VForm-MqJCh6j8.js";import{V as J,a as O}from"./VRow-CBIZXy0V.js";import{V as Q}from"./VTextField-C5K-JLC3.js";import{V as W}from"./VAutocomplete-CtJ28T1f.js";import{V as X}from"./VNavigationDrawer-C1kAe-dV.js";import{$ as U}from"./api-B6c1NHMd.js";import{V as de}from"./VSpacer-DO_vufVD.js";import{V as me}from"./VDataTable-Cq00Lau-.js";import{V as H}from"./VTooltip-DriPcYkZ.js";import{V as ue}from"./VSnackbar-CFNgeUZK.js";import{V as pe}from"./VDialog-q404EtSX.js";import"./helpers-BO_WrFPz.js";import"./VAvatar-A7ztkq2k.js";import"./VImg-BvvxBpKO.js";import"./InputIcon-C91L1USK.js";import"./forwardRefs-C-GTDzx5.js";/* empty css              *//* empty css                   */import"./VCounter-OXl0Qa9T.js";import"./VField-BD5A6g5X.js";import"./easing-CjukEv2V.js";import"./VInput-j0tWo3aL.js";import"./VSelect-DD45070D.js";import"./VList-jAkofN4n.js";import"./ssrBoot-CpQaGIBj.js";import"./dialog-transition-Cr9rcsZj.js";import"./VMenu-Dwo0kCga.js";import"./VOverlay-BtLUM5vY.js";import"./delay-Dhu81iSy.js";import"./lazy-CojwJwNx.js";import"./scopeId-C1Mw3z0g.js";import"./VCheckboxBtn-ybuIpKJx.js";import"./VSelectionControl-CA9osU1B.js";import"./VChip-D3GIz1VX.js";import"./VSlideGroup-DZ8i23BH.js";import"./filter--_JGeJ5X.js";import"./index-9rIf2CJL.js";import"./VPagination-Bz8XJ3Wz.js";import"./VTable-XmEDbQ3e.js";const fe=A({__name:"AddNewDepartmentDrawer",props:{isDrawerOpen:{type:Boolean},errors:{},users:{}},emits:["update:isDrawerOpen","departmentData"],setup(T,{expose:f,emit:C}){const d=T,u=C,_=i(!1),c=i(),p=i(""),m=i(),y=()=>{u("update:isDrawerOpen",!1),L(()=>{var a,r;(a=c.value)==null||a.reset(),(r=c.value)==null||r.resetValidation()})},S=()=>{var a;(a=c.value)==null||a.validate().then(({valid:r})=>{r&&u("departmentData",{name:p.value,leader_id:m.value})})};f({closeNavigationDrawer:y});const N=a=>{u("update:isDrawerOpen",a)},V=d.users.map(a=>({title:a.name,value:a.id}));return(a,r)=>{const D=G;return F(),P(X,{temporary:"",width:400,location:"end","model-value":d.isDrawerOpen,"onUpdate:modelValue":N},{default:t(()=>[e(D,{title:"Add Department",onCancel:y}),e(I),e(R,{flat:""},{default:t(()=>[e(E,null,{default:t(()=>[e(K,{ref_key:"refForm",ref:c,modelValue:s(_),"onUpdate:modelValue":r[2]||(r[2]=n=>w(_)?_.value=n:null),onSubmit:j(S,["prevent"])},{default:t(()=>[e(J,null,{default:t(()=>[e(O,{cols:"12"},{default:t(()=>[e(Q,{modelValue:s(p),"onUpdate:modelValue":r[0]||(r[0]=n=>w(p)?p.value=n:null),rules:["requiredValidator"in a?a.requiredValidator:s(B)],label:"Name","error-messages":d.errors.name,placeholder:"Department Name"},null,8,["modelValue","rules","error-messages"])]),_:1}),e(O,{cols:"12"},{default:t(()=>[e(W,{modelValue:s(m),"onUpdate:modelValue":r[1]||(r[1]=n=>w(m)?m.value=n:null),items:s(V),rules:["requiredValidator"in a?a.requiredValidator:s(B)],label:"Leader","error-messages":d.errors.leader_id,placeholder:"Select Leader"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),e(O,{cols:"12"},{default:t(()=>[e(k,{type:"submit",class:"me-4"},{default:t(()=>[v(" Submit ")]),_:1}),e(k,{type:"reset",variant:"outlined",color:"error",onClick:y},{default:t(()=>[v(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),ce=A({__name:"EditDepartmentDrawer",props:{isDrawerOpen:{type:Boolean},errors:{},department:{},users:{}},emits:["update:isDrawerOpen","departmentData"],setup(T,{expose:f,emit:C}){const d=T,u=C,_=i(!1),c=i(),p=i(d.department.name),m=i(d.department.leader_id);re(()=>d.department,a=>{p.value=a.title,m.value=a.leader_id},{immediate:!0,deep:!0});const y=()=>{u("update:isDrawerOpen",!1),L(()=>{var a,r;(a=c.value)==null||a.reset(),(r=c.value)==null||r.resetValidation()})},S=()=>{var a;(a=c.value)==null||a.validate().then(({valid:r})=>{r&&u("departmentData",{id:d.department.id,name:p.value,leader_id:m.value})})};f({closeNavigationDrawer:y});const N=a=>{u("update:isDrawerOpen",a)},V=d.users.map(a=>({title:a.name,value:a.id}));return(a,r)=>{const D=G;return F(),P(X,{temporary:"",width:400,location:"end","model-value":d.isDrawerOpen,"onUpdate:modelValue":N},{default:t(()=>[e(D,{title:"Edit Department",onCancel:y}),e(I),e(R,{flat:""},{default:t(()=>[e(E,null,{default:t(()=>[e(K,{ref_key:"refForm",ref:c,modelValue:s(_),"onUpdate:modelValue":r[2]||(r[2]=n=>w(_)?_.value=n:null),onSubmit:j(S,["prevent"])},{default:t(()=>[e(J,null,{default:t(()=>[e(O,{cols:"12"},{default:t(()=>[e(Q,{modelValue:s(p),"onUpdate:modelValue":r[0]||(r[0]=n=>w(p)?p.value=n:null),rules:["requiredValidator"in a?a.requiredValidator:s(B)],label:"Name","error-messages":d.errors.name,placeholder:"Department Name"},null,8,["modelValue","rules","error-messages"])]),_:1}),e(O,{cols:"12"},{default:t(()=>[e(W,{modelValue:s(m),"onUpdate:modelValue":r[1]||(r[1]=n=>w(m)?m.value=n:null),items:s(V),rules:["requiredValidator"in a?a.requiredValidator:s(B)],label:"Leader","error-messages":d.errors.leader_id,placeholder:"Select Leader"},null,8,["modelValue","items","rules","error-messages"])]),_:1}),e(O,{cols:"12"},{default:t(()=>[e(k,{type:"submit",class:"me-4"},{default:t(()=>[v(" Submit ")]),_:1}),e(k,{type:"reset",variant:"outlined",color:"error",onClick:y},{default:t(()=>[v(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),ve=se("span",null,"Departments",-1),na=A({__name:"list",async setup(T){let f,C;const d=i({name:""});let u,_;const c=i(),p=i(),m=i(),y=[{title:"ID",key:"id"},{title:"Name",key:"title"},{title:"Leader",key:"leader"},{title:"Actions",key:"actions",sortable:!1}],{departments:S}=([f,C]=M(()=>U("departments")),f=await f,C(),f),{users:N}=([f,C]=M(()=>U("users")),f=await f,C(),f),V=i(S),a=i(!1),r=i(!1),D=i(!1),n=i(!1);let x;const Y=async b=>{const{success:l,message:g,department:$}=await U("/departments",{method:"POST",body:b,onResponseError({response:o}){q.value=o._data.errors}});l&&(D.value=!0,V.value=[...V.value,$],x=g,c.value.closeNavigationDrawer(),L(()=>{m.value.$el.querySelector(".v-table__wrapper").scrollTop=m.value.$el.querySelector(".v-table__wrapper").scrollHeight}))},Z=async b=>{const{success:l,message:g,department:$}=await U(`departments/${b.id}`,{method:"PUT",body:b,onResponseError({response:o}){q.value=o._data.errors}});l&&(D.value=!0,V.value[_]=$,x=g,p.value.closeNavigationDrawer())},h=b=>{d.value=b,_=V.value.indexOf(b),r.value=!0},ee=async()=>{const{success:b,message:l}=await U(`departments/${u}`,{method:"DELETE"});n.value=!1,b&&(D.value=!0,x=l,V.value=V.value.filter(g=>g.id!==u))},q=i({name:void 0});return(b,l)=>{const g=ne("IconBtn"),$=te;return F(),le("section",null,[e(R,{class:"mb-6"},{default:t(()=>[e(ie,{class:"d-flex align-center my-2"},{default:t(()=>[ve,e(de),e(k,{onClick:l[0]||(l[0]=o=>a.value=!0),"prepend-icon":"ri-user-add-fill"},{default:t(()=>[v(" Add New Department ")]),_:1})]),_:1}),e(I),e(me,{hover:"","fixed-header":"",style:{"max-height":"600px"},items:s(V),"item-value":"id",ref_key:"dataTableRef",ref:m,headers:y,class:"text-no-wrap rounded-0",density:"default"},{"item.actions":t(({item:o})=>[e(g,{size:"small",onClick:ae=>h(o),color:"primary",disabled:o.id>=1&&o.id<=5},{default:t(()=>[e(z,{icon:"ri-edit-box-line"}),e(H,{activator:"parent",location:"top"},{default:t(()=>[v(" Edit ")]),_:1})]),_:2},1032,["onClick","disabled"]),e(g,{size:"small",onClick:ae=>{n.value=!0,w(u)?u.value=o.id:u=o.id},color:"error",disabled:o.id>=1&&o.id<=5},{default:t(()=>[e(z,{icon:"ri-delete-bin-7-line"}),e(H,{activator:"parent",location:"top"},{default:t(()=>[v(" Delete ")]),_:1})]),_:2},1032,["onClick","disabled"])]),_:1},8,["items"])]),_:1}),e(fe,{isDrawerOpen:s(a),"onUpdate:isDrawerOpen":l[1]||(l[1]=o=>w(a)?a.value=o:null),onDepartmentData:Y,ref_key:"addNewDepartmentDrawerRef",ref:c,errors:s(q),users:s(N)},null,8,["isDrawerOpen","errors","users"]),e(ce,{isDrawerOpen:s(r),"onUpdate:isDrawerOpen":l[2]||(l[2]=o=>w(r)?r.value=o:null),onDepartmentData:Z,department:s(d),ref_key:"editDepartmentDrawerRef",ref:p,errors:s(q),users:s(N)},null,8,["isDrawerOpen","department","errors","users"]),e(ue,{modelValue:s(D),"onUpdate:modelValue":l[4]||(l[4]=o=>w(D)?D.value=o:null)},{actions:t(()=>[e(k,{color:"error",onClick:l[3]||(l[3]=o=>D.value=!1)},{default:t(()=>[v(" Close ")]),_:1})]),default:t(()=>[v(oe(s(x))+" ",1)]),_:1},8,["modelValue"]),e(pe,{modelValue:s(n),"onUpdate:modelValue":l[8]||(l[8]=o=>w(n)?n.value=o:null),width:"400"},{default:t(()=>[e(R,{title:"Confirmation",class:"pb-5"},{default:t(()=>[e($,{variant:"text",size:"default",onClick:l[5]||(l[5]=o=>n.value=!1)}),e(E,null,{default:t(()=>[v(" Are you sure you want to delete this department? ")]),_:1}),e(E,{class:"d-flex align-center justify-center gap-4"},{default:t(()=>[e(k,{variant:"elevated",onClick:l[6]||(l[6]=o=>ee()),color:"error"},{default:t(()=>[v(" Confirm ")]),_:1}),e(k,{color:"secondary",variant:"outlined",onClick:l[7]||(l[7]=o=>n.value=!1)},{default:t(()=>[v(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{na as default};
