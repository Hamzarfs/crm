import{b as De,f as Ie}from"./formatters-DvWGt13L.js";import{d as se,r as $,o as v,g as U,f as t,b as e,a0 as c,p as g,e as i,n as a,aG as H,c as C,x as G,a$ as ve,ai as ae,a as re,w as xe,Z as O,F as R,i as F,s as _e,v as b,j as be,I as q,J,aL as j,z as te,aM as Te,H as Re}from"./main-DoQFmMsa.js";import{_ as ke}from"./MoreBtn.vue_vue_type_script_setup_true_lang-DpYF8E9m.js";import{C as pe}from"./vue3-perfect-scrollbar-Dah25qMm.js";import{I as Ue,L as Be}from"./index-OuvZIdlx.js";import{u as ze,S as Ne,P as Fe,U as Pe,E as Oe}from"./index-CKaYAiOH.js";import{c as je,a as He,V as X,b as Z}from"./VCard-CvMXks-w.js";import{V as Q}from"./VTextField-C5K-JLC3.js";import{V as z}from"./VDivider-CiGpRMeQ.js";import{V as W}from"./VSpacer-DO_vufVD.js";import{V as ye}from"./VChip-D3GIz1VX.js";import{_ as qe}from"./TiptapEditor.vue_vue_type_style_index_1_lang-BZRfywlN.js";import{$ as ge}from"./api-B6c1NHMd.js";import{V as B}from"./VTooltip-DriPcYkZ.js";import{V as le}from"./VMenu-Dwo0kCga.js";import{V as ie,a as oe,b as ne}from"./VList-jAkofN4n.js";import{V as $e}from"./VAvatar-A7ztkq2k.js";import{V as ue}from"./VImg-BvvxBpKO.js";import{V as Ce}from"./VNavigationDrawer-C1kAe-dV.js";import{V as we}from"./VBadge-Q3x4SoPx.js";import{u as Je,a as Ge,V as Ke}from"./VMain-Dh9q-9mA.js";import{u as We}from"./useApi-CYcmTCPZ.js";import{c as Ze}from"./createUrl-Bwjf_k-d.js";import{V as he}from"./VCheckbox-CMyJEiVW.js";import"./helpers-BO_WrFPz.js";/* empty css                   */import"./VCounter-OXl0Qa9T.js";import"./VField-BD5A6g5X.js";import"./InputIcon-C91L1USK.js";import"./easing-CjukEv2V.js";import"./VInput-j0tWo3aL.js";import"./forwardRefs-C-GTDzx5.js";/* empty css              */import"./VSlideGroup-DZ8i23BH.js";import"./index-w_tptuY5.js";import"./index-9rIf2CJL.js";import"./VOverlay-BtLUM5vY.js";import"./delay-Dhu81iSy.js";import"./lazy-CojwJwNx.js";import"./scopeId-C1Mw3z0g.js";import"./dialog-transition-Cr9rcsZj.js";import"./ssrBoot-CpQaGIBj.js";import"./VCheckboxBtn-ybuIpKJx.js";import"./VSelectionControl-CA9osU1B.js";const Qe={class:"px-1 pe-6 py-1"},Xe=i("div",{class:"text-disabled font-weight-medium"}," To: ",-1),Ye={class:"cursor-pointer text-medium-emphasis"},et=i("span",{class:"mx-1"},"|",-1),tt={key:0},at=i("div",{class:"text-disabled font-weight-medium"}," Cc: ",-1),lt={key:0},it=i("div",{class:"text-disabled font-weight-medium"}," Bcc: ",-1),ot=i("div",{class:"text-disabled font-weight-medium"}," Subject: ",-1),nt={class:"tiptap-editor-wrapper"},st={key:0,class:"d-flex flex-wrap gap-x-1 px-4 py-2"},rt={class:"mx-5"},dt={class:"d-flex align-center px-5 py-4 gap-4"},ct=se({__name:"ComposeDialog",emits:["close"],setup(L){const A=$(""),m=$(""),w=$(""),k=$(""),E=$(""),M=$(""),D=$(!1),u=$(!1),V=()=>{m.value=w.value=k.value=""},r=ze({content:"",extensions:[Ne,Ue,Fe.configure({placeholder:"Message"}),Pe,Be.configure({openOnClick:!1})]}),y=()=>{var d,s,_;const h=(d=r.value)==null?void 0:d.getAttributes("link").href,l=window.prompt("URL",h);if(l!==null){if(l===""){(s=r.value)==null||s.chain().focus().extendMarkRange("link").unsetLink().run();return}(_=r.value)==null||_.chain().focus().extendMarkRange("link").setLink({href:l}).run()}},I=()=>{var l;const h=window.prompt("URL");h&&((l=r.value)==null||l.chain().focus().setImage({src:h}).run())};return(h,l)=>{const d=re("IconBtn");return v(),U(X,{class:"email-compose-dialog",elevation:"24","max-width":"30vw"},{default:t(()=>[e(He,{class:"py-3"},{append:t(()=>[e(d,{onClick:l[0]||(l[0]=s=>h.$emit("close"))},{default:t(()=>[e(c,{icon:"ri-subtract-line"})]),_:1}),e(d,{onClick:l[1]||(l[1]=s=>{h.$emit("close"),V(),D.value=!1,u.value=!1})},{default:t(()=>[e(c,{icon:"ri-close-line"})]),_:1})]),default:t(()=>[e(je,{class:"text-medium-emphasis"},{default:t(()=>[g(" Compose Mail ")]),_:1})]),_:1}),i("div",Qe,[e(Q,{modelValue:a(m),"onUpdate:modelValue":l[4]||(l[4]=s=>H(m)?m.value=s:null),density:"compact"},{"prepend-inner":t(()=>[Xe]),append:t(()=>[i("span",Ye,[i("span",{onClick:l[2]||(l[2]=s=>D.value=!a(D))},"Cc"),et,i("span",{onClick:l[3]||(l[3]=s=>u.value=!a(u))},"Bcc")])]),_:1},8,["modelValue"])]),e(ve,null,{default:t(()=>[a(D)?(v(),C("div",tt,[e(z),e(Q,{modelValue:a(E),"onUpdate:modelValue":l[5]||(l[5]=s=>H(E)?E.value=s:null),density:"compact"},{"prepend-inner":t(()=>[at]),_:1},8,["modelValue"])])):G("",!0)]),_:1}),e(ve,null,{default:t(()=>[a(u)?(v(),C("div",lt,[e(z),e(Q,{modelValue:a(M),"onUpdate:modelValue":l[6]||(l[6]=s=>H(M)?M.value=s:null),density:"compact"},{"prepend-inner":t(()=>[it]),_:1},8,["modelValue"])])):G("",!0)]),_:1}),e(z),e(Q,{modelValue:a(w),"onUpdate:modelValue":l[7]||(l[7]=s=>H(w)?w.value=s:null),density:"compact"},{"prepend-inner":t(()=>[ot]),_:1},8,["modelValue"]),e(z),i("div",nt,[a(r)?(v(),C("div",st,[e(d,{rounded:"",color:a(r).isActive("bold")?"primary":"",variant:a(r).isActive("bold")?"tonal":"text",onClick:l[8]||(l[8]=s=>a(r).chain().focus().toggleBold().run())},{default:t(()=>[e(c,{icon:"ri-bold"})]),_:1},8,["color","variant"]),e(d,{rounded:"",color:a(r).isActive("underline")?"primary":"",variant:a(r).isActive("underline")?"tonal":"text",onClick:l[9]||(l[9]=s=>a(r).commands.toggleUnderline())},{default:t(()=>[e(c,{icon:"ri-underline"})]),_:1},8,["color","variant"]),e(d,{rounded:"",color:a(r).isActive("italic")?"primary":"",variant:a(r).isActive("italic")?"tonal":"text",onClick:l[10]||(l[10]=s=>a(r).chain().focus().toggleItalic().run())},{default:t(()=>[e(c,{icon:"ri-italic"})]),_:1},8,["color","variant"]),e(d,{rounded:"",color:a(r).isActive("bulletList")?"primary":"",variant:a(r).isActive("bulletList")?"tonal":"text",onClick:l[11]||(l[11]=s=>a(r).chain().focus().toggleBulletList().run())},{default:t(()=>[e(c,{icon:"ri-list-check"})]),_:1},8,["color","variant"]),e(d,{rounded:"",color:a(r).isActive("orderedList")?"primary":"",variant:a(r).isActive("orderedList")?"tonal":"text",onClick:l[12]||(l[12]=s=>a(r).chain().focus().toggleOrderedList().run())},{default:t(()=>[e(c,{icon:"ri-list-ordered-2"})]),_:1},8,["color","variant"]),e(d,{rounded:"",onClick:y},{default:t(()=>[e(c,{icon:"ri-links-line"})]),_:1}),e(d,{rounded:"",onClick:I},{default:t(()=>[e(c,{icon:"ri-image-line"})]),_:1})])):G("",!0),e(z),i("div",rt,[e(a(Oe),{editor:a(r)},null,8,["editor"])])]),i("div",dt,[e(ae,{"append-icon":"ri-send-plane-line",disabled:a(m)==="",onClick:l[13]||(l[13]=s=>{h.$emit("close"),A.value="",V(),D.value=!1,u.value=!1})},{default:t(()=>[g(" Send ")]),_:1},8,["disabled"]),e(d,null,{default:t(()=>[e(c,{icon:"ri-attachment-2"})]),_:1}),e(W),e(d,null,{default:t(()=>[e(c,{icon:"ri-more-2-line"})]),_:1}),e(d,{onClick:l[14]||(l[14]=s=>{h.$emit("close"),V(),A.value="",D.value=!1,u.value=!1})},{default:t(()=>[e(c,{icon:"ri-delete-bin-7-line"})]),_:1})])]),_:1})}}}),ut={class:"d-flex flex-column h-100"},mt={class:"pa-5"},pt={class:"email-filters-labels"},ft=["href","onClick"],vt=i("li",{class:"text-sm d-block text-uppercase text-disabled mt-9 mb-4"}," LABELS ",-1),_t=["href","onClick"],gt=se({inheritAttrs:!1,__name:"EmailLeftSidebarContent",props:{emailsMeta:{}},emits:["toggleComposeDialogVisibility"],setup(L){const A=L,m=$(0),w=$(0),k=$(0),E=$(0);xe(()=>A.emailsMeta,u=>{u&&(m.value=u.inbox,w.value=u.draft,k.value=u.spam,E.value=u.star)},{immediate:!0,deep:!0});const M=O(()=>[{title:"Inbox",prependIcon:"ri-mail-line",to:{name:"apps-email"},badge:{content:m.value,color:"primary"}},{title:"Sent",prependIcon:"ri-send-plane-line",to:{name:"apps-email-filter",params:{filter:"sent"}}},{title:"Draft",prependIcon:"ri-edit-box-line",to:{name:"apps-email-filter",params:{filter:"draft"}},badge:{content:w.value,color:"warning"}},{title:"Starred",prependIcon:"ri-star-line",to:{name:"apps-email-filter",params:{filter:"starred"}},badge:{content:E.value,color:"success"}},{title:"Spam",prependIcon:"ri-spam-2-line",to:{name:"apps-email-filter",params:{filter:"spam"}},badge:{content:k.value,color:"error"}},{title:"Trash",prependIcon:"ri-delete-bin-7-line",to:{name:"apps-email-filter",params:{filter:"trashed"}}}]),D=[{title:"Personal",color:"success",to:{name:"apps-email-label",params:{label:"personal"}}},{title:"Company",color:"primary",to:{name:"apps-email-label",params:{label:"company"}}},{title:"Important",color:"warning",to:{name:"apps-email-label",params:{label:"important"}}},{title:"Private",color:"error",to:{name:"apps-email-label",params:{label:"private"}}}];return(u,V)=>{const r=re("RouterLink");return v(),C("div",ut,[i("div",mt,[e(ae,{block:"",onClick:V[0]||(V[0]=y=>u.$emit("toggleComposeDialogVisibility"))},{default:t(()=>[g(" Compose ")]),_:1})]),e(a(pe),{options:{wheelPropagation:!1},class:"h-100 pt-4"},{default:t(()=>[i("ul",pt,[(v(!0),C(R,null,F(a(M),y=>(v(),U(r,{key:y.title,class:"d-flex align-center cursor-pointer",to:y.to,custom:""},{default:t(({isActive:I,href:h,navigate:l})=>{var d;return[i("li",_e({ref_for:!0},u.$attrs,{href:h,class:[I&&"email-filter-active text-primary","d-flex align-center cursor-pointer"],onClick:l}),[e(c,{icon:y.prependIcon,class:"me-2",size:"20"},null,8,["icon"]),i("span",null,b(y.title),1),e(W),(d=y.badge)!=null&&d.content?(v(),U(ye,{key:0,size:"x-small",color:y.badge.color},{default:t(()=>[g(b(y.badge.content),1)]),_:2},1032,["color"])):G("",!0)],16,ft)]}),_:2},1032,["to"]))),128)),vt,(v(),C(R,null,F(D,y=>e(r,{key:y.title,class:"d-flex align-center",to:y.to,custom:""},{default:t(({isActive:I,href:h,navigate:l})=>[i("li",_e({ref_for:!0},u.$attrs,{href:h,class:[I&&"email-label-active text-primary","cursor-pointer"],onClick:l}),[e(c,{color:y.color,icon:"ri-circle-fill",size:"12",class:"me-2"},null,8,["color"]),i("span",null,b(y.title),1)],16,_t)]),_:2},1032,["to"])),64))])]),_:1})])}}}),me=()=>{const L=be(),A=async(u,V)=>{await ge("apps/email",{method:"POST",body:JSON.stringify({ids:u,data:V})})};return{labels:[{title:"personal",color:"success"},{title:"company",color:"primary"},{title:"important",color:"warning"},{title:"private",color:"error"}],resolveLabelColor:u=>u==="personal"?"success":u==="company"?"primary":u==="important"?"warning":u==="private"?"error":"secondary",shallShowMoveToActionFor:u=>u==="trash"?L.params.filter!=="trashed":u==="inbox"?!(L.params.filter===void 0||L.params.filter==="sent"||L.params.filter==="draft"):u==="spam"?!(L.params.filter==="spam"||L.params.filter==="sent"||L.params.filter==="draft"):!1,emailMoveToFolderActions:[{action:"inbox",icon:"ri-mail-line"},{action:"spam",icon:"ri-spam-2-line"},{action:"trash",icon:"ri-delete-bin-line"}],moveSelectedEmailTo:async(u,V)=>{const r={};u==="inbox"?(L.params.filter==="trashed"&&(r.isDeleted=!1),r.folder="inbox"):u==="spam"?(L.params.filter==="trashed"&&(r.isDeleted=!1),r.folder="spam"):u==="trash"&&(r.isDeleted=!0),await A(V,r)},updateEmails:A,updateEmailLabels:async(u,V)=>{await ge("/apps/email",{method:"POST",body:{ids:u,label:V}})}}},ht={class:"email-view-header d-flex align-center px-5 py-4"},xt={class:"d-flex align-center flex-wrap flex-grow-1 overflow-hidden gap-2"},bt={class:"text-h6 font-weight-regular text-truncate"},kt={class:"d-flex flex-wrap gap-2"},yt={class:"d-flex align-center gap-2"},$t={class:"email-view-action-bar d-flex align-center text-medium-emphasis gap-1 px-5"},Ct={class:"d-flex align-center gap-x-1"},wt={class:"d-flex align-start"},Vt={class:"d-flex flex-wrap flex-grow-1 overflow-hidden"},Et={class:"text-truncate"},Mt={class:"text-h6 font-weight-regular text-truncate"},St={class:"text-body-2 mb-0"},Lt={class:"d-flex align-center"},At={class:"text-disabled me-4"},Dt={class:"text-body-1 font-weight-medium text-truncate mb-4"},It=["innerHTML"],Tt=i("span",null,"2 Attachments",-1),Rt={class:"text-base"},Ut=i("span",{class:"text-primary cursor-pointer"}," Forward ",-1),Bt={class:"text-body-1 text-high-emphasis mb-4"},zt={class:"d-flex justify-end gap-4 pt-2 flex-wrap"},Nt=se({__name:"EmailView",props:{email:{},emailMeta:{}},emits:["refresh","navigated","close","trash","unread","read","star","unstar"],setup(L,{emit:A}){const m=L,w=A,k=$(""),E=$(!1),M=$(!0),{updateEmailLabels:D}=me(),{labels:u,resolveLabelColor:V,emailMoveToFolderActions:r,shallShowMoveToActionFor:y,moveSelectedEmailTo:I}=me(),h=async d=>{await I(d,[m.email.id]),w("refresh"),w("close")},l=async d=>{await D([m.email.id],d),w("refresh")};return(d,s)=>{const _=re("IconBtn"),Y=ke,de=qe;return v(),U(Ce,{temporary:"","model-value":!!m.email,location:"right",scrim:!1,floating:"",class:"email-view"},{default:t(()=>[m.email?(v(),C(R,{key:0},[i("div",ht,[e(_,{class:"me-2 flip-in-rtl",onClick:s[0]||(s[0]=p=>{d.$emit("close"),E.value=!1,M.value=!0,k.value=""})},{default:t(()=>[e(c,{icon:"ri-arrow-left-s-line"})]),_:1}),i("div",xt,[i("h6",bt,b(m.email.subject),1),i("div",kt,[(v(!0),C(R,null,F(m.email.labels,p=>(v(),U(ye,{key:p,color:a(V)(p),size:"small",class:"text-capitalize flex-shrink-0"},{default:t(()=>[g(b(p),1)]),_:2},1032,["color"]))),128))])]),i("div",yt,[e(_,{variant:"plain",disabled:!m.emailMeta.hasPreviousEmail,class:"flip-in-rtl",onClick:s[1]||(s[1]=p=>d.$emit("navigated","previous"))},{default:t(()=>[e(c,{icon:"ri-arrow-left-s-line"})]),_:1},8,["disabled"]),e(_,{variant:"plain",class:"flip-in-rtl",disabled:!m.emailMeta.hasNextEmail,onClick:s[2]||(s[2]=p=>d.$emit("navigated","next"))},{default:t(()=>[e(c,{icon:"ri-arrow-right-s-line"})]),_:1},8,["disabled"])])]),e(z),i("div",$t,[q(e(_,{onClick:s[3]||(s[3]=p=>{d.$emit("trash"),d.$emit("close")})},{default:t(()=>[e(c,{icon:"ri-delete-bin-7-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Delete Mail ")]),_:1})]),_:1},512),[[J,!m.email.isDeleted]]),e(_,{onClick:s[4]||(s[4]=j(p=>{d.$emit("unread"),d.$emit("close")},["stop"]))},{default:t(()=>[e(c,{icon:"ri-mail-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Mark as Unread ")]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{icon:"ri-folder-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Move to ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(v(!0),C(R,null,F(a(r),p=>(v(),U(oe,{key:p.title,class:te([a(y)(p.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:N=>h(p.action)},{prepend:t(()=>[e(c,{icon:p.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(ne,{class:"text-capitalize"},{default:t(()=>[g(b(p.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(c,{icon:"ri-price-tag-3-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Label ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(v(!0),C(R,null,F(a(u),p=>(v(),U(oe,{key:p.title,href:"#",onClick:j(N=>l(p.title),["stop"])},{prepend:t(()=>[e(we,{inline:"",color:a(V)(p.title),dot:""},null,8,["color"])]),default:t(()=>[e(ne,{class:"ms-2 text-capitalize"},{default:t(()=>[g(b(p.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(W),i("div",Ct,[e(_,{color:m.email.isStarred?"warning":"default",onClick:s[5]||(s[5]=p=>{var N;(N=m.email)!=null&&N.isStarred?d.$emit("unstar"):d.$emit("star"),d.$emit("refresh")})},{default:t(()=>[e(c,{color:m.email.isStarred?"warning":"",icon:"ri-star-line"},null,8,["color"])]),_:1},8,["color"]),e(Y)])]),e(z),e(a(pe),{tag:"div",class:"mail-content-container flex-grow-1 pa-sm-12 pa-6",options:{wheelPropagation:!1}},{default:t(()=>[e(X,{class:"mb-4"},{default:t(()=>[e(Z,{class:"mail-header"},{default:t(()=>[i("div",wt,[e($e,{size:"38",class:"me-3"},{default:t(()=>[e(ue,{src:m.email.from.avatar,alt:m.email.from.name},null,8,["src","alt"])]),_:1}),i("div",Vt,[i("div",Et,[i("h6",Mt,b(m.email.from.name),1),i("p",St,b(m.email.from.email),1)]),e(W),i("div",Lt,[i("span",At,b(("formatDate"in d?d.formatDate:a(De))(m.email.time)),1),q(e(_,null,{default:t(()=>[e(c,{icon:"ri-attachment-2"})]),_:1},512),[[J,m.email.attachments.length]])])]),e(Y,{class:"align-self-sm-center"})])]),_:1}),e(z),e(Z,null,{default:t(()=>[i("div",Dt,b(m.email.from.name)+", ",1),i("div",{class:"text-base",innerHTML:m.email.message},null,8,It)]),_:1}),m.email.attachments.length?(v(),C(R,{key:0},[e(z),e(Z,{class:"d-flex flex-column gap-y-4 pt-4"},{default:t(()=>[Tt,(v(!0),C(R,null,F(m.email.attachments,p=>(v(),C("div",{key:p.fileName,class:"d-flex align-center"},[e(ue,{src:p.thumbnail,alt:p.fileName,"aspect-ratio":"1","max-height":"24","max-width":"24",class:"me-2"},null,8,["src","alt"]),i("span",null,b(p.fileName),1)]))),128))]),_:1})],64)):G("",!0)]),_:1}),q(e(X,null,{default:t(()=>[e(Z,{class:"font-weight-medium text-high-emphasis"},{default:t(()=>[i("div",Rt,[g(" Click here to "),i("span",{class:"text-primary cursor-pointer",onClick:s[6]||(s[6]=p=>{E.value=!a(E),M.value=!a(M)})}," Reply "),g(" or "),Ut])]),_:1})]),_:1},512),[[J,a(M)]]),a(E)?(v(),U(X,{key:0},{default:t(()=>[e(Z,null,{default:t(()=>{var p;return[i("h6",Bt," Reply to "+b((p=d.email)==null?void 0:p.from.name),1),e(de,{modelValue:a(k),"onUpdate:modelValue":s[7]||(s[7]=N=>H(k)?k.value=N:null),placeholder:"Write your message...","is-divider":!1},null,8,["modelValue"]),i("div",zt,[e(_,{icon:"ri-delete-bin-7-line",onClick:s[8]||(s[8]=N=>{E.value=!a(E),M.value=!a(M),k.value=""})}),e(ae,{variant:"text",color:"secondary"},{prepend:t(()=>[e(c,{icon:"ri-attachment-2",class:"text-high-emphasis"})]),default:t(()=>[g(" Attachments ")]),_:1}),e(ae,{"append-icon":"ri-send-plane-line"},{default:t(()=>[g(" Send ")]),_:1})])]}),_:1})]),_:1})):G("",!0)]),_:1})],64)):G("",!0)]),_:1},8,["model-value"])}}}),Ft={class:"d-flex align-center"},Pt={class:"py-2 px-4 d-flex align-center"},Ot=["onClick"],jt={class:"text-h6"},Ht={class:"text-body-2 truncate"},qt={class:"text-sm text-disabled"},Jt={class:"email-actions d-none"},Gt={class:"py-4 px-5 text-center"},Kt=i("span",{class:"text-high-emphasis"},"No items found.",-1),Wt=[Kt],Fa=se({__name:"index",async setup(L){let A,m;const{isLeftSidebarOpen:w}=Je(),k=be(),{labels:E,resolveLabelColor:M,emailMoveToFolderActions:D,shallShowMoveToActionFor:u,moveSelectedEmailTo:V,updateEmails:r,updateEmailLabels:y}=me(),I=$(!1),h=$(""),l=$([]),{data:d,execute:s}=([A,m]=Te(()=>We(Ze("/apps/email",{query:{q:h,filter:()=>"filter"in k.params?k.params.filter:void 0,label:()=>"label"in k.params?k.params.label:void 0}}))),A=await A,m(),A),_=O(()=>d.value.emails),Y=O(()=>d.value.emailsMeta),de=f=>{const o=l.value.indexOf(f);o===-1?l.value.push(f):l.value.splice(o,1)},p=O(()=>_.value.length&&_.value.length===l.value.length),N=O(()=>!!l.value.length&&_.value.length!==l.value.length),ce=O(()=>l.value.every(f=>{var o;return(o=_.value.find(S=>S.id===f))==null?void 0:o.isRead})),Ve=()=>{l.value=p.value?[]:_.value.map(f=>f.id)},x=$(null),Ee=O(()=>{const f={hasNextEmail:!1,hasPreviousEmail:!1};if(x.value){const o=_.value.findIndex(S=>{var K;return S.id===((K=x.value)==null?void 0:K.id)});f.hasNextEmail=!!_.value[o+1],f.hasPreviousEmail=!!_.value[o-1]}return f}),fe=async()=>{await s(),x.value&&(x.value=_.value.find(f=>{var o;return f.id===((o=x.value)==null?void 0:o.id)}))},T=async(f,o=l.value)=>{l.value=[],o.length&&(f==="trash"?await r(o,{isDeleted:!0}):f==="spam"?await r(o,{folder:"spam"}):f==="unread"?await r(o,{isRead:!1}):f==="read"?await r(o,{isRead:!0}):f==="star"?await r(o,{isStarred:!0}):f==="unstar"&&await r(o,{isStarred:!1}),x.value?fe():await s())},Me=async f=>{await V(f,l.value),await s()},Se=async f=>{await y(l.value,f),await s()},Le=f=>{if(!x.value)return;const o=_.value.findIndex(K=>{var n;return K.id===((n=x.value)==null?void 0:n.id)}),S=f==="previous"?o-1:o+1;x.value=_.value[S]},Ae=async f=>{x.value=f,await T("read",[f.id])};return xe(()=>k.params,()=>{l.value=[]},{deep:!0}),(f,o)=>{const S=re("IconBtn"),K=ke;return v(),U(Ke,{style:{"z-index":"0","min-block-size":"100%"},class:"email-app-layout"},{default:t(()=>[e(Ce,{modelValue:a(w),"onUpdate:modelValue":o[1]||(o[1]=n=>H(w)?w.value=n:null),absolute:"",touchless:"",location:"start",temporary:f.$vuetify.display.mdAndDown},{default:t(()=>[e(gt,{"emails-meta":a(Y),onToggleComposeDialogVisibility:o[0]||(o[0]=n=>I.value=!a(I))},null,8,["emails-meta"])]),_:1},8,["modelValue","temporary"]),e(Nt,{email:a(x),"email-meta":a(Ee),onRefresh:fe,onNavigated:Le,onClose:o[2]||(o[2]=n=>x.value=null),onTrash:o[3]||(o[3]=n=>T("trash",a(x)?[a(x).id]:[])),onUnread:o[4]||(o[4]=n=>T("unread",a(x)?[a(x).id]:[])),onStar:o[5]||(o[5]=n=>T("star",a(x)?[a(x).id]:[])),onUnstar:o[6]||(o[6]=n=>T("unstar",a(x)?[a(x).id]:[]))},null,8,["email","email-meta"]),e(Ge,null,{default:t(()=>[e(X,{flat:"",class:"email-content-list h-100 d-flex flex-column"},{default:t(()=>[i("div",Ft,[e(S,{class:"d-lg-none ms-3",onClick:o[7]||(o[7]=n=>w.value=!0)},{default:t(()=>[e(c,{icon:"ri-menu-line"})]),_:1}),e(Q,{modelValue:a(h),"onUpdate:modelValue":o[8]||(o[8]=n=>H(h)?h.value=n:null),density:"default",class:"email-search px-1 flex-grow-1",placeholder:"Search mail"},{"prepend-inner":t(()=>[e(c,{color:"disabled",size:"22",icon:"ri-search-line"})]),_:1},8,["modelValue"])]),e(z),i("div",Pt,[e(he,{"model-value":a(p),indeterminate:a(N),class:"d-flex","onUpdate:modelValue":Ve},null,8,["model-value","indeterminate"]),i("div",{class:"w-100 d-flex align-center action-bar-actions gap-1",style:Re({visibility:a(N)||a(p)?void 0:"hidden"})},[q(e(S,{onClick:o[9]||(o[9]=n=>T("trash"))},{default:t(()=>[e(c,{icon:"ri-delete-bin-7-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Delete Mail ")]),_:1})]),_:1},512),[[J,"filter"in a(k).params?a(k).params.filter!=="trashed":!0]]),e(S,{onClick:o[10]||(o[10]=n=>a(ce)?T("unread"):T("read"))},{default:t(()=>[e(c,{icon:a(ce)?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(b(a(ce)?"Mark as Unread":"Mark as Read"),1)]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(c,{icon:"ri-folder-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Folder ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(v(!0),C(R,null,F(a(D),n=>(v(),U(oe,{key:n.title,class:te([a(u)(n.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:ee=>Me(n.action)},{prepend:t(()=>[e(c,{icon:n.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(ne,{class:"text-capitalize"},{default:t(()=>[g(b(n.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(c,{icon:"ri-price-tag-3-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Label ")]),_:1}),e(le,{activator:"parent"},{default:t(()=>[e(ie,{density:"compact"},{default:t(()=>[(v(!0),C(R,null,F(a(E),n=>(v(),U(oe,{key:n.title,href:"#",onClick:ee=>Se(n.title)},{prepend:t(()=>[e(we,{inline:"",color:a(M)(n.title),dot:""},null,8,["color"])]),default:t(()=>[e(ne,{class:"ms-2 text-capitalize"},{default:t(()=>[g(b(n.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})],4),e(W),e(S,{class:"me-1",onClick:a(s)},{default:t(()=>[e(c,{icon:"ri-refresh-line"})]),_:1},8,["onClick"]),e(K)]),e(z),e(a(pe),{tag:"ul",options:{wheelPropagation:!1},class:"email-list"},{default:t(()=>[(v(!0),C(R,null,F(a(_),n=>{var ee;return q((v(),C("li",{key:n.id,class:te(["email-item d-flex align-center pa-4 gap-2 cursor-pointer",[{"email-read":n.isRead}]]),onClick:P=>Ae(n)},[e(he,{"model-value":a(l).includes(n.id),class:"flex-shrink-0","onUpdate:modelValue":P=>de(n.id),onClick:o[11]||(o[11]=j(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"]),e(S,{color:n.isStarred?"warning":"default",onClick:j(P=>T(n.isStarred?"unstar":"star",[n.id]),["stop"])},{default:t(()=>[e(c,{icon:"ri-star-line"})]),_:2},1032,["color","onClick"]),e($e,{size:"32"},{default:t(()=>[e(ue,{src:n.from.avatar,alt:n.from.name},null,8,["src","alt"])]),_:2},1024),i("h6",jt,b(n.from.name),1),i("span",Ht,b(n.subject),1),e(W),i("div",{class:te(["email-meta align-center gap-2",f.$vuetify.display.xs?"d-none":""])},[(v(!0),C(R,null,F(n.labels,P=>(v(),U(c,{key:P,icon:"ri-circle-fill",size:"10",color:a(M)(P)},null,8,["color"]))),128)),i("span",qt,b(("formatDateToMonthShort"in f?f.formatDateToMonthShort:a(Ie))(n.time)),1)],2),i("div",Jt,[e(S,{onClick:j(P=>T("trash",[n.id]),["stop"])},{default:t(()=>[e(c,{icon:"ri-delete-bin-7-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Delete Mail ")]),_:1})]),_:2},1032,["onClick"]),e(S,{class:"mx-2",onClick:j(P=>T(n.isRead?"unread":"read",[n.id]),["stop"])},{default:t(()=>[e(c,{icon:n.isRead?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(b(n.isRead?"Mark as Unread":"Mark as Read"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(S,{onClick:j(P=>T("spam",[n.id]),["stop"])},{default:t(()=>[e(c,{icon:"ri-error-warning-line"}),e(B,{activator:"parent",location:"top"},{default:t(()=>[g(" Move to Spam ")]),_:1})]),_:2},1032,["onClick"])])],10,Ot)),[[J,(ee=a(_))==null?void 0:ee.length]])}),128)),q(i("li",Gt,Wt,512),[[J,!a(_).length]])]),_:1})]),_:1}),q(e(ct,{onClose:o[12]||(o[12]=n=>I.value=!1)},null,512),[[J,a(I)]])]),_:1})]),_:1})}}});export{Fa as default};
